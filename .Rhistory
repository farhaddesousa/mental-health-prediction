load("C:/Users/farha/Desktop/USC/Academic/Fall 2022 Classes/Math 550 - Data Analysis/Project/mhcld_puf_2019_r.RData")
data = data.frame(df)
selected_data = subset(data, select = -c(YEAR, CASEID, STATEFIP, DIVISION, MH2, MH3))
attach(selected_data)
#Removing rows with missing SMISED, converting to factors
cleaned_data = subset(selected_data, SMISED != -9)
col_names <- names(cleaned_data)
cleaned_data[,col_names] <- lapply(cleaned_data[,col_names] , factor)
SMISED = as.factor(SMISED)
#Training and test split
sample <- sample(c(TRUE, FALSE), nrow(cleaned_data), replace=TRUE, prob=c(0.7,0.3))
train  <- cleaned_data[sample, ]
test   <- cleaned_data[!sample, ]
#Simple Classification Tree
library(ISLR)
library(tree)
boost.SMISED = gbm(SMISED ~., data=train, distribution="multinomial",
n.trees=500,
interaction.depth=1)
#Boosting
library(gbm)
boost.SMISED = gbm(SMISED ~., data=train, distribution="multinomial",
n.trees=500,
interaction.depth=1)
selected_data = subset(data, select = -c(YEAR, CASEID, STATEFIP))
attach(selected_data)
#Removing rows with missing SMISED, converting to factors
cleaned_data = subset(selected_data, SMISED != -9)
col_names <- names(cleaned_data)
cleaned_data[,col_names] <- lapply(cleaned_data[,col_names] , factor)
SMISED = as.factor(SMISED)
#Training and test split
sample <- sample(c(TRUE, FALSE), nrow(cleaned_data), replace=TRUE, prob=c(0.7,0.3))
train  <- cleaned_data[sample, ]
test   <- cleaned_data[!sample, ]
#Simple Classification Tree
library(ISLR)
library(tree)
tree.SMISED <- tree(SMISED ~ ., data = train)
summary(tree.SMISED)
plot(tree.SMISED)
text(tree.SMISED, pretty = 0)
tree.pred = predict(tree.SMISED, test, type = "class")
table (tree.pred,test$SMISED)
100* (205466+ 93076 + 121817)/nrows(test$SMISED)
100* (205466+ 93076 + 121817)/nrow(test$SMISED)
nrow(test)
100* (205466+ 93076 + 121817)/nrow(test)
100 - 23.44
load("C:/Desktop Folders/USC/Academic/2022-3-Fall/Math 550 - Data Analysis/Project/mhcld_puf_2019_r.RData")
head(df)
